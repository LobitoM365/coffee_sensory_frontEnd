<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador de Excel con Estilos</title>
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
        }

        th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: rgb(204, 30, 30);
        }
    </style>
</head>
<body>
    <h1>Generador de Excel con Estilos</h1>
    <button onclick="exportToExcel()">Exportar a Excel</button>

    <table id="dataTable">
        <thead>
            <tr>
                <th>Nombre</th>
                <th>Edad</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Juan</td>
                <td>30</td>
            </tr>
            <tr>
                <td>Mar√≠a</td>
                <td>25</td>
            </tr>
            <tr>
                <td>Pedro</td>
                <td>35</td>
            </tr>
        </tbody>
    </table>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.3.0/exceljs.min.js"></script>
    <script>
        function exportToExcel() {
            const workbook = new ExcelJS.Workbook();
            const worksheet = workbook.addWorksheet('Sheet1');

            // Obtener la tabla
            const table = document.getElementById('dataTable');

            // Recorrer las filas y celdas de la tabla y agregarlas al libro de Excel
            const rows = table.querySelectorAll('tr');
            rows.forEach(row => {
                const rowData = [];
                row.querySelectorAll('td, th').forEach(cell => {
                    rowData.push(cell.innerText);
                });
                worksheet.addRow(rowData);
            });

            // Aplicar estilos al archivo de Excel
            worksheet.eachRow(row => {
                row.eachCell(cell => {
                    cell.font = {
                        name: 'Arial',
                        bold: true,
                        size: 12,
                        color: { argb: 'red' },
                        
                    };
                    cell.alignment = { vertical: 'middle', horizontal: 'center' };
                    cell.border = {
                        top: { style: 'thin' },
                        left: { style: 'thin' },
                        bottom: { style: 'thin' },
                        right: { style: 'thin' }
                    };
                });
            });

            // Escribir el libro a un archivo
            workbook.xlsx.writeBuffer().then(buffer => {
                const blob = new Blob([buffer], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'mi_archivo.xlsx';
                a.click();
            });
        }
    </script>
</body>
</html>
